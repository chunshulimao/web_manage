(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6fb3e6ac"],{"1e74":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"home"},[a("div",{staticClass:"content"},[a("div",{staticClass:"rate"},[a("div",{staticClass:"flex align-center justify-center"},[a("div",[t._v(t._s(t.$t("newMakeMoney")))])]),a("div",{staticClass:"flex align-center justify-center "},[a("div",[t._v("1 "+t._s(t.tokenName)+" = "+t._s(t.lockDetail.buybackData.buybackRate)+" "+t._s(t.tokenName1))])])]),a("div",{staticClass:"flex dividerContent"},[a("div",{staticClass:"flex align-center  flex-column pb-1"},[a("div",{staticClass:"font-bold mb-05"},[t._v(t._s(t.lockDetail.buybackData.buybackTokens))]),a("div",{staticClass:"dec"},[t._v(t._s(t.$t("inbuybackCount"))+"（"+t._s(t.tokenName)+"）")])]),a("div",{staticStyle:{width:"1px",height:"22px",background:"#919191"}}),a("div",{staticClass:"flex align-center flex-column pb-1"},[a("div",{staticClass:"font-bold mb-05"},[t._v(t._s(t.lockDetail.buybackData.buybackAvailEths))]),a("div",{staticClass:"dec"},[t._v(t._s(t.$t("surplusFunding"))+"（"+t._s(t.tokenName1)+")")])])]),a("div",{staticClass:"flex align-center",staticStyle:{"margin-top":"13px","margin-bottom":"12px"}},[a("div",{staticStyle:{"margin-right":"8px","flex-shrink":"0"}},[t._v(t._s(t.$t("buybackNumber")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.buybackValue,expression:"buybackValue"}],staticClass:"input",attrs:{type:"number"},domProps:{value:t.buybackValue},on:{input:function(e){e.target.composing||(t.buybackValue=e.target.value)}}}),a("div",{staticStyle:{"margin-left":"8px"}},[t._v(t._s(t.tokenName))])]),a("div",[a("div",{staticClass:"dec"},[t._v(t._s(t.$t("maxRedemption"))),a("span",[t._v(" "+t._s(t.lockDetail.buybackData.tokenLimit))]),t._v(" "+t._s(t.tokenName)+" ")]),a("div",{staticClass:"dec"},[t._v(t._s(t.$t("walletMoney"))+" "),a("span",[t._v(t._s(t.lockDetail.buybackData.tokenBalance))]),t._v(" "+t._s(t.tokenName)+" ")])]),a("div",{staticClass:"btn",on:{click:function(e){t.approved?t.sendBuyback():t.approveToken()}}},[t._v(" "+t._s(t.approved?t.$t("promptBuyback"):"Approve")+" ")])])]),a("div",{staticClass:"info"},[t._v(t._s(t.$t("buybackRemarksText")))])])},r=[],c=a("1da1"),s=(a("a9e3"),a("96cf"),a("2b0e")),i=a("9ed2"),o=a("d399"),u=a("a232"),b=a("b775");s["a"].use(i["a"]);var l={name:"BuyBack",data:function(){return{lockDetail:{},investValue:"",tokenName:this.$config.project.dao.bsc[0].symbol,tokenName1:this.$config.project.dao.bsc[0].symbol1,contract:null,tokenContract:null,approved:!1,buybackValue:""}},methods:{toInvestDest:function(){this.$router.push("/buyBackDesc")},toStatic:function(){this.$router.push("/buybackStatistics")},getContractData:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.contract.methods.getBuybackInfoCollections().call();case 2:return a=e.sent,e.next=5,t.contract.methods.getCanRedeemToken(t.$web3Obj.currentAddress).call();case 5:return n=e.sent,e.next=8,t.tokenContract.methods.balanceOf(t.$web3Obj.currentAddress).call();case 8:return r=e.sent,e.abrupt("return",{buybackRate:Object(u["transformationNumber"])(a._lastPrice),buybackTokens:Object(u["transformationNumber"])(a._buybackAllTokenNum),buybackAvailEths:Object(u["transformationNumber"])(a._unredeem),tokenLimit:Object(u["transformationNumber"])(n),tokenBalance:Object(u["transformationNumber"])(r)});case 10:case"end":return e.stop()}}),e)})))()},getApprove:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.tokenContract.methods.allowance(t.$web3Obj.currentAddress,t.lockDetail.buyback).call();case 2:a=e.sent,Number(a)>1e3&&(t.approved=!0);case 4:case"end":return e.stop()}}),e)})))()},approveToken:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b["a"].contractSend(t.tokenContract.methods.approve(t.lockDetail.buyback,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff").send({from:t.$web3Obj.currentAddress}));case 3:t.approved=!0,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},sendBuyback:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!isNaN(this.buybackValue)){t.next=4;break}return Object(o["a"])("invalid number1"),t.abrupt("return");case 4:if(e=Number(this.buybackValue),!(e<=0||e>this.lockDetail.buybackData.tokenLimit||e>this.lockDetail.buybackData.tokenBalance)){t.next=8;break}return Object(o["a"])("invalid number"),t.abrupt("return");case 8:b["a"].contractSend(this.contract.methods.buybackToken(Object(u["transformationNumber18"])(e)).send({from:this.$web3Obj.currentAddress})),this.buybackValue="",t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,12]])})));function e(){return t.apply(this,arguments)}return e}()},created:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lockDetail=this.$config.project.dao.bsc[0].lock[this.$route.query.index],this.contract=new this.$web3Obj.web3.eth.Contract(this.$config.abi.buyback,this.lockDetail.buyback),t.next=4,this.contract.methods.getTokenContractAddr().call();case 4:e=t.sent,this.tokenContract=new this.$web3Obj.web3.eth.Contract(this.$config.abi.token,e),this.getApprove(),this.getContractData().then((function(t){a.lockDetail.buybackData=t}));case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},f=l,k=(a("3f98"),a("2877")),d=Object(k["a"])(f,n,r,!1,null,"4e762924",null);e["default"]=d.exports},"3f98":function(t,e,a){"use strict";a("6b9d")},"6b9d":function(t,e,a){}}]);