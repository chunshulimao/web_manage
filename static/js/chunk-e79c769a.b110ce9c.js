(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e79c769a"],{2838:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home poolContent home70"},[n("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[e._v(" "+e._s(e.item.projectName)+" ")]),n("div",{staticStyle:{background:"#1d1e23",padding:"15px","border-radius":"10px"}},[n("div",{staticClass:"flex align-center justify-between"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.tokenIndex,expression:"tokenIndex"}],staticClass:" active btn",staticStyle:{width:"100%",height:"40px","margin-bottom":"10px"},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.tokenIndex=t.target.multiple?n:n[0]},function(t){return e.switchToken(e.tokenIndex)}]}},e._l(this.item.tokens,(function(t,r){return n("option",{staticStyle:{color:"black"},domProps:{value:r}},[e._v(e._s(t.tokenName)+"（下拉选择） ")])})),0)]),n("div",[n("div",[e._v("合约地址: "+e._s(e.contractAddress))]),n("div",[e._v("当前管理的token地址: "+e._s(e.item.tokens[this.tokenIndex].address))]),n("div",[e._v("链接的钱包余额: "+e._s(e.userTokenBlance))]),n("div",[e._v("合约内余额: "+e._s(e.contractTokenBalance))]),n("div",[e._v("已授权数量: "+e._s(e.userApproveTokenNum))]),n("div",[e._v(" 共管成员: "),e._l(e.DAOMembers,(function(t){return n("div",[e._v(" "+e._s(t)+" ")])}))],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.shows,expression:"shows === 1"}],staticStyle:{"margin-top":"13px","margin-bottom":"12px"}},[this.item.tokens[this.tokenIndex].contractType?e._e():n("div",{staticClass:"flex align-center justify-between"},[n("div",{staticClass:"title font-bold",staticStyle:{"margin-right":"8px"}},[e._v("授权数量")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.approveTokenNum,expression:"approveTokenNum"}],staticStyle:{height:"28px","border-radius":"4px",border:"1px solid #909090",width:"100%"},attrs:{type:"text"},domProps:{value:e.approveTokenNum},on:{input:function(t){t.target.composing||(e.approveTokenNum=t.target.value)}}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:2===e.shows,expression:"shows === 2"}],staticClass:"flex align-center justify-between",staticStyle:{"margin-top":"13px","margin-bottom":"12px"}},[n("div",{staticClass:"title font-bold",staticStyle:{"margin-right":"8px"}},[e._v("存入数量")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.depositTokenNum,expression:"depositTokenNum"}],staticStyle:{height:"28px","border-radius":"4px",border:"1px solid #909090",width:"100%"},attrs:{type:"text"},domProps:{value:e.depositTokenNum},on:{input:function(t){t.target.composing||(e.depositTokenNum=t.target.value)}}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:3===e.shows,expression:"shows === 3"}],staticStyle:{"margin-top":"13px","margin-bottom":"12px"}},[n("div",{staticClass:"flex align-center justify-between"},[n("div",{staticClass:"title font-bold",staticStyle:{"margin-right":"8px"}},[e._v("钱包地址")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.transferTokenTo,expression:"transferTokenTo"}],staticStyle:{height:"28px","border-radius":"4px",border:"1px solid #909090",width:"100%"},attrs:{type:"text"},domProps:{value:e.transferTokenTo},on:{input:function(t){t.target.composing||(e.transferTokenTo=t.target.value)}}})]),n("div",{staticClass:"flex align-center justify-between mt-3"},[n("div",{staticClass:"title font-bold",staticStyle:{"margin-right":"8px"}},[e._v("转账数量")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.transferTokenNum,expression:"transferTokenNum"}],staticStyle:{height:"28px","border-radius":"4px",border:"1px solid #909090",width:"100%"},attrs:{type:"text"},domProps:{value:e.transferTokenNum},on:{input:function(t){t.target.composing||(e.transferTokenNum=t.target.value)}}})])]),n("div",{staticClass:"flex align-center justify-between my-1",staticStyle:{"flex-wrap":"wrap"}},[n("div",{staticClass:"tab",class:{active:1==e.shows},on:{click:function(t){return e.doneTab(1)}}},[e._v(" 授权 ")]),n("div",{staticClass:"tab",class:{active:2==e.shows},on:{click:function(t){return e.doneTab(2)}}},[e._v(" 存入 ")]),n("div",{staticClass:"tab",class:{active:3==e.shows},on:{click:function(t){return e.doneTab(3)}}},[e._v(" 转账 ")]),n("div",{staticClass:"tab",class:{active:4==e.shows},on:{click:function(t){return e.doneTab(4)}}},[e._v(" 清算 ")])]),n("div",{staticClass:"tab active",staticStyle:{width:"100%","margin-top":"50px"},on:{click:e.send}},[e._v("确认")])])])},s=[],i=n("1da1"),a=(n("96cf"),n("2b0e")),o=n("d399"),c=n("4128"),u=n.n(c),d=n("a232"),l=n("b775");a["a"].use(o["a"]),u.a.set({precision:100,toExpPos:60,toExpNeg:-20});var h={data:function(){return{DAOMembers:[],tokenIndex:null,contractAddress:null,shows:1,rules:{name:[function(e){return(e||"").length>0||"This field is required"}]},currentAddress:this.$web3Obj.currentAddress,investValue:"",contractTokenBalance:0,userTokenBlance:0,tokenRate:0,userApproveTokenNum:0,approveTokenNum:null,depositTokenNum:null,transferTokenNum:null,transferTokenTo:"",showApp:!0,jointWalletContract:null,tokenContract:null,item:null,decimals:18}},created:function(){var e=this.$route.query.network,t=this.$route.query.index,n=this.$config.project.publicv3[e]?this.$config.project.publicv3[e]:[];this.item=n[t],this.tokenIndex=0,this.contractAddress=this.item.contractAddress,this.jointWalletContract=new this.$web3Obj.web3.eth.Contract(this.item.contractType?this.$config.abi[this.item.contractType]:this.$config.abi.JointWallet,this.contractAddress),this.switchToken()},methods:{send:function(){switch(this.shows){case 1:this.approve();break;case 2:this.depositToken();break;case 3:this.transferToken();break;case 4:this.tokenLiquidation();break}},doneTab:function(e){this.shows=e},switchToken:function(){var e=this.item.tokens[this.tokenIndex].contractType;this.tokenContract=new this.$web3Obj.web3.eth.Contract(e?this.$config.abi[e]:this.$config.abi.token,this.item.tokens[this.tokenIndex].address),this.getOverview()},getOverview:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.userApproveTokenNum=0,this.userTokenBlance=0,this.contractTokenBalance=0,"ONEDAONFT"!==this.item.tokens[this.tokenIndex].contractType){e.next=15;break}return e.next=6,this.tokenContract.methods.isApprovedForAll(this.$web3Obj.currentAddress,this.contractAddress).call();case 6:return this.userApproveTokenNum=e.sent,e.next=9,this.tokenContract.methods.balanceOf(this.$web3Obj.currentAddress).call();case 9:return this.userTokenBlance=e.sent,e.next=12,this.tokenContract.methods.balanceOf(this.contractAddress).call();case 12:this.contractTokenBalance=e.sent,e.next=30;break;case 15:return e.next=17,this.tokenContract.methods.decimals().call();case 17:return this.decimals=e.sent,e.next=20,this.tokenContract.methods.allowance(this.$web3Obj.currentAddress,this.contractAddress).call();case 20:return t=e.sent,this.userApproveTokenNum=Object(d["transformationNumber"])(t,4,this.decimals),e.next=24,this.tokenContract.methods.balanceOf(this.$web3Obj.currentAddress).call();case 24:return n=e.sent,this.userTokenBlance=Object(d["transformationNumber"])(n,4,this.decimals),e.next=28,this.tokenContract.methods.balanceOf(this.contractAddress).call();case 28:r=e.sent,this.contractTokenBalance=Object(d["transformationNumber"])(r,4,this.decimals);case 30:return e.next=32,this.jointWalletContract.methods.overview().call();case 32:this.DAOMembers=e.sent._members;case 33:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),approve:function(){"ONEDAONFT"===this.item.tokens[this.tokenIndex].contractType?this.approveNFT():this.approveToken()},approveToken:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Object(d["invalidNumber"])(this.approveTokenNum)){e.next=3;break}return Object(o["a"])("无效的授权数量"),e.abrupt("return");case 3:if(t=confirm("确认授权本合约"+this.approveTokenNum),!t){e.next=8;break}return e.next=7,l["a"].contractSend(this.tokenContract.methods.approve(this.contractAddress,Object(d["transformationNumber18"])(this.approveTokenNum,this.decimals)).send({from:this.currentAddress}));case 7:this.getOverview();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),approveNFT:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].contractSend(e.tokenContract.methods.setApprovalForAll(e.contractAddress,!0).send({from:e.$web3Obj.currentAddress}));case 2:e.getOverview();case 3:case"end":return t.stop()}}),t)})))()},depositToken:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Object(d["invalidNumber"])(this.depositTokenNum)){e.next=3;break}return Object(o["a"])("无效的存入数量"),e.abrupt("return");case 3:if(t=confirm("确认存入"+this.depositTokenNum),!t){e.next=8;break}return e.next=7,l["a"].contractSend(this.jointWalletContract.methods.deposit(this.item.tokens[this.tokenIndex].address,Object(d["transformationNumber18"])(this.depositTokenNum,this.decimals)).send({from:this.currentAddress}));case 7:this.getOverview();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),transferToken:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Object(d["invalidNumber"])(this.transferTokenNum)){e.next=3;break}return Object(o["a"])("无效的转账数量"),e.abrupt("return");case 3:if(this.transferTokenTo&&!(this.transferTokenTo.length<40)){e.next=6;break}return Object(o["a"])("无效的转账地址"),e.abrupt("return");case 6:if(t=confirm("确认转账"+this.transferTokenNum+"到地址:"+this.transferTokenTo),!t){e.next=11;break}return e.next=10,l["a"].contractSend(this.jointWalletContract.methods.transferVote(this.item.tokens[this.tokenIndex].address,this.transferTokenTo,Object(d["transformationNumber18"])(this.transferTokenNum,this.decimals)).send({from:this.currentAddress}));case 10:this.getOverview();case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),tokenLiquidation:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=confirm("确认清算么"),!t){e.next=5;break}return e.next=4,l["a"].contractSend(this.jointWalletContract.methods.liquidationVote(this.item.tokens[this.tokenIndex].address).send({from:this.currentAddress}));case 4:this.getOverview();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},p=h,m=(n("fbd8"),n("2877")),v=Object(m["a"])(p,r,s,!1,null,"3091016a",null);t["default"]=v.exports},8531:function(e,t,n){},fbd8:function(e,t,n){"use strict";n("8531")}}]);